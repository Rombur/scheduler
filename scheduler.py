#! /usr/bin/env python3
#----------------------------------------------------------------------------#
# Python code
# Author: Bruno Turcksin
# Date: 2014-09-03 14:55:39.995505
#----------------------------------------------------------------------------#

"""This is the driver for the program that implements the CAP-FBP heuristic"""

import random
import time
import BRANCH_AND_BOUND
import CAP_PFB
import TASK


start = time.time()
print_output = False
init_sched = 'serial'
randomized = False
random.seed(0)
forbid_oscillations = False
do_local_search = False
branch_and_bound = True
max_it = 20
tol = 1e-3
sn = 8  #2, 4, 8, 16
#n_x = 2
#n_y = 2
#n_p = [[0,1],[2,3]]
#delta_t = [[4,4],[4,4]]
#n_x = 4
#n_y = 4
#n_p = [[0, 0, 1, 1], [0, 0, 1, 1], [2, 2, 3, 3], [2, 2, 3, 3]]
#delta_t = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
#n_p = [[0, 0, 1, 1], [0, 0, 1, 1], [2, 2, 3, 3], [2, 2, 3, 3]]
##delta_t = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
#n_p = [[0, 1, 0, 1], [2, 3, 2, 3], [0, 1, 0, 1], [2, 3, 2, 3]]
#delta_t = [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
#n_x = 10
#n_y = 10
#n_p = [[0,1,2,3,4,5,6,7,8,9],[10,11,12,13,14,15,16,17,18,19],
#    [20,21,22,23,24,25,26,27,28,29],[30,31,32,33,34,35,36,37,38,39],
#    [40,41,42,43,44,45,46,47,48,49],[50,51,52,53,54,55,56,57,58,59],
#    [60,61,62,63,64,65,66,67,68,69],[70,71,72,73,74,75,76,77,78,79],
#    [80,81,82,83,84,85,86,87,88,89],[90,91,92,93,94,95,96,97,98,99]]
#delta_t = [[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],
#    [1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],
#    [1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],
#    [1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],
#    [1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1]]
#cells_to_refine = []
#n_x = 30
#n_y = 30
#n_p = [[i for i in range(0,30)],[i for i in range(30,60)],[i for i in range(60,90)],
#        [i for i in range(90,120)],[i for i in range(120,150)],[i for i in range(150,180)],
#        [i for i in range(180,210)],[i for i in range(210,240)],[i for i in range(240,270)],
#        [i for i in range(270,300)],[i for i in range(300,330)],[i for i in range(330,360)],
#        [i for i in range(360,390)],[i for i in range(390,420)],[i for i in range(420,450)],
#        [i for i in range(450,480)],[i for i in range(480,510)],[i for i in range(510,540)],
#        [i for i in range(540,570)],[i for i in range(570,600)],[i for i in range(600,630)],
#        [i for i in range(630,660)],[i for i in range(660,690)],[i for i in range(690,720)],
#        [i for i in range(720,750)],[i for i in range(750,780)],[i for i in range(780,810)],
#        [i for i in range(810,840)],[i for i in range(840,870)],[i for i in range(870,900)]]
#delta_t = [[1]*30]*30
#cells_to_refine = []
#n_x = 50
#n_y = 50
#n_p = [[i for i in range(0,50)],[i for i in range(50,100)],
#        [i for i in range(100,150)],[i for i in range(150,200)],
#        [i for i in range(200,250)],[i for i in range(250,300)],
#        [i for i in range(300,350)],[i for i in range(350,400)],
#        [i for i in range(400,450)],[i for i in range(450,500)],
#        [i for i in range(500,550)],[i for i in range(550,600)],
#        [i for i in range(600,650)],[i for i in range(650,700)],
#        [i for i in range(700,750)],[i for i in range(750,800)],
#        [i for i in range(800,850)],[i for i in range(850,900)],
#        [i for i in range(900,950)],[i for i in range(950,1000)],
#        [i for i in range(1000,1050)],[i for i in range(1050,1100)],
#        [i for i in range(1100,1150)],[i for i in range(1150,1200)],
#        [i for i in range(1200,1250)],[i for i in range(1250,1300)],
#        [i for i in range(1300,1350)],[i for i in range(1350,1400)],
#        [i for i in range(1400,1450)],[i for i in range(1450,1500)],
#        [i for i in range(1500,1550)],[i for i in range(1550,1600)],
#        [i for i in range(1600,1650)],[i for i in range(1650,1700)],
#        [i for i in range(1700,1750)],[i for i in range(1750,1800)],
#        [i for i in range(1800,1850)],[i for i in range(1850,1900)],
#        [i for i in range(1900,1950)],[i for i in range(1950,2000)],
#        [i for i in range(2000,2050)],[i for i in range(2050,2100)],
#        [i for i in range(2100,2150)],[i for i in range(2150,2200)],
#        [i for i in range(2200,2250)],[i for i in range(2250,2300)],
#        [i for i in range(2300,2350)],[i for i in range(2350,2400)],
#        [i for i in range(2400,2450)],[i for i in range(2450,2500)]]
#delta_t = [[1]*50]*50
#cells_to_refine= []
#n_x = 70
#n_y = 70
#n_p = [[i for i in range(0,70)],[i for i in range(70,140)],         
#        [i for i in range(140,210)],[i for i in range(210,280)],    
#        [i for i in range(280,350)],[i for i in range(350,420)],    
#        [i for i in range(420,490)],[i for i in range(490,560)],    
#        [i for i in range(560,630)],[i for i in range(630,700)],    
#        [i for i in range(700,770)],[i for i in range(770,840)],
#        [i for i in range(840,910)],[i for i in range(910,980)],
#        [i for i in range(980,1050)],[i for i in range(1050,1120)],
#        [i for i in range(1120,1190)],[i for i in range(1190,1260)],
#        [i for i in range(1260,1330)],[i for i in range(1330,1400)],
#        [i for i in range(1400,1470)],[i for i in range(1470,1540)],
#        [i for i in range(1540,1610)],[i for i in range(1610,1680)],
#        [i for i in range(1680,1750)],[i for i in range(1750,1820)],
#        [i for i in range(1820,1890)],[i for i in range(1890,1960)],
#        [i for i in range(1960,2030)],[i for i in range(2030,2100)],
#        [i for i in range(2100,2170)],[i for i in range(2170,2240)],
#        [i for i in range(2240,2310)],[i for i in range(2310,2380)],
#        [i for i in range(2380,2450)],[i for i in range(2450,2520)],
#        [i for i in range(2520,2590)],[i for i in range(2590,2660)],
#        [i for i in range(2660,2730)],[i for i in range(2730,2800)],
#        [i for i in range(2800,2870)],[i for i in range(2870,2940)],
#        [i for i in range(2940,3010)],[i for i in range(3010,3080)],
#        [i for i in range(3080,3150)],[i for i in range(3150,3220)],
#        [i for i in range(3220,3290)],[i for i in range(3290,3360)],
#        [i for i in range(3360,3430)],[i for i in range(3500,3570)],
#        [i for i in range(3500,3570)],[i for i in range(3570,3640)], 
#        [i for i in range(3640,3710)],[i for i in range(3710,3780)], 
#        [i for i in range(3780,3850)],[i for i in range(3850,3920)], 
#        [i for i in range(3920,3990)],[i for i in range(3990,4060)], 
#        [i for i in range(4060,4130)],[i for i in range(4130,4200)], 
#        [i for i in range(4200,4270)],[i for i in range(4270,4340)], 
#        [i for i in range(4340,4410)],[i for i in range(4410,4480)], 
#        [i for i in range(4480,4550)],[i for i in range(4550,4620)], 
#        [i for i in range(4620,4690)],[i for i in range(4690,4760)], 
#        [i for i in range(4760,4830)],[i for i in range(4830,4900)]]
#delta_t = [[1]*70]*70
#n_x = 20
#n_y = 20
#n_p = [[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9],       
#        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9],
#        [10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29],
#        [20,20,21,21,22,22,23,23,24,24,25,26,26,26,27,27,28,28,29,29],
#        [30,30,31,31,32,32,33,34,35,36,37,38,39,40,41,41,42,42,43,43],
#        [30,30,31,31,32,32,44,45,46,47,48,49,50,51,41,41,42,42,43,43],
#        [52,52,53,53,54,54,55,56,57,58,59,60,61,62,63,63,64,64,65,65],
#        [52,52,53,53,54,54,66,67,68,69,70,71,72,73,63,63,64,64,65,65],
#        [74,74,75,75,76,76,77,78,79,80,81,82,83,84,85,85,86,86,87,87],
#        [74,74,75,75,76,76,88,89,90,91,92,93,94,95,85,85,86,86,87,87],
#        [96,96,97,97,98,98,99,100,101,102,103,104,105,106,107,107,108,108,109,109],
#        [96,96,97,97,98,98,110,111,112,113,114,115,116,117,107,107,108,108,109,109],
#        [118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127],
#        [118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127],
#        [128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137],
#        [128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137],
#        [138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147],
#        [138,138,139,139,140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147]]
#
#delta_t = [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,4,4,4,4,4,4,4,4,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
#        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]
#
#cells_to_refine=[]
#cells_to_refine=[[6,6],[6,7],[6,8],[6,9],[6,10],[6,11],[6,12],[6,13],
#        [7,6],[7,7],[7,8],[7,9],[7,10],[7,11],[7,12],[7,13],
#        [8,6],[8,7],[8,8],[8,9],[8,10],[8,11],[8,12],[8,13],
#        [9,6],[9,7],[9,8],[9,9],[9,10],[9,11],[9,12],[9,13],
#        [10,6],[10,7],[10,8],[10,9],[10,10],[10,11],[10,12],[10,13],
#        [11,6],[11,7],[11,8],[11,9],[11,10],[11,11],[11,12],[11,13],
#        [12,6],[12,7],[12,8],[12,9],[12,10],[12,11],[12,12],[12,13],
#        [13,6],[13,7],[13,8],[13,9],[13,10],[13,11],[13,12],[13,13]]

n_x = 40
n_y = 40
n_p =[[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99],
        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99],
        [100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119],
        [100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119],
        [120,120,121,121,122,122,123,123,124,124,125,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,142,143,143,144,144,145,145,146,146,147,147],
        [120,120,121,121,122,122,123,123,124,124,125,125,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,142,142,143,143,144,144,145,145,146,146,147,147],
        [164,164,165,165,166,166,167,167,168,168,169,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,186,187,187,188,188,189,189,190,190,191,191],
        [164,164,165,165,166,166,167,167,168,168,169,169,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,186,186,187,187,188,188,189,189,190,190,191,191],
        [208,208,209,209,210,210,211,211,212,212,213,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,230,231,231,232,232,233,233,234,234,235,235],
        [208,208,209,209,210,210,211,211,212,212,213,213,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,230,230,231,231,232,232,233,233,234,234,235,235],
        [252,252,253,253,254,254,255,255,256,256,257,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,274,275,275,276,276,277,277,278,278,279,279],
        [252,252,253,253,254,254,255,255,256,256,257,257,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,274,274,275,275,276,276,277,277,278,278,279,279],
        [296,296,297,297,298,298,299,299,300,300,301,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,318,319,319,320,320,321,321,322,322,323,323],
        [296,296,297,297,298,298,299,299,300,300,301,301,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,318,318,319,319,320,320,321,321,322,322,323,323],
        [340,340,341,341,342,342,343,343,344,344,345,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,362,363,363,364,364,365,365,366,366,367,367],
        [340,340,341,341,342,342,343,343,344,344,345,345,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,362,362,363,363,364,364,365,365,366,366,367,367],
        [384,384,385,385,386,386,387,387,388,388,389,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,406,407,407,408,408,409,409,410,410,411,411],
        [384,384,385,385,386,386,387,387,388,388,389,389,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,406,406,407,407,408,408,409,409,410,410,411,411],
        [428,428,429,429,430,430,431,431,432,432,433,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,450,451,451,452,452,453,453,454,454,455,455],
        [428,428,429,429,430,430,431,431,432,432,433,433,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,450,450,451,451,452,452,453,453,454,454,455,455],
        [472,472,473,473,474,474,475,475,476,476,477,477,478,478,479,479,480,480,481,481,482,482,483,483,484,484,485,485,486,486,487,487,488,488,489,489,490,490,491,491],
        [472,472,473,473,474,474,475,475,476,476,477,477,478,478,479,479,480,480,481,481,482,482,483,483,484,484,485,485,486,486,487,487,488,488,489,489,490,490,491,491],
        [492,492,493,493,494,494,495,495,496,496,497,497,498,498,499,499,500,500,501,501,502,502,503,503,504,504,505,505,506,506,507,507,508,508,509,509,510,510,511,511],
        [492,492,493,493,494,494,495,495,496,496,497,497,498,498,499,499,500,500,501,501,502,502,503,503,504,504,505,505,506,506,507,507,508,508,509,509,510,510,511,511],
        [512,512,513,513,514,514,515,515,516,516,517,517,518,518,519,519,520,520,521,521,522,522,523,523,524,524,525,525,526,526,527,527,528,528,529,529,530,530,531,531],
        [512,512,513,513,514,514,515,515,516,516,517,517,518,518,519,519,520,520,521,521,522,522,523,523,524,524,525,525,526,526,527,527,528,528,529,529,530,530,531,531],
        [532,532,533,533,534,534,535,555,536,536,537,537,538,538,539,539,540,540,541,541,542,542,543,543,544,544,545,545,546,546,547,547,548,548,549,549,550,550,551,551],
        [532,532,533,533,534,534,535,555,536,536,537,537,538,538,539,539,540,540,541,541,542,542,543,543,544,544,545,545,546,546,547,547,548,548,549,549,550,550,551,551],
        [552,552,553,553,554,554,555,555,556,556,557,557,558,558,559,559,560,560,561,561,562,562,563,563,564,564,565,565,566,566,567,567,568,568,569,569,570,570,571,571],
        [552,552,553,553,554,554,555,555,556,556,557,557,558,558,559,559,560,560,561,561,562,562,563,563,564,564,565,565,566,566,567,567,568,568,569,569,570,570,571,571],
        [572,572,573,573,574,574,575,575,576,576,577,577,578,578,579,579,580,580,581,581,582,582,583,583,584,584,585,585,586,586,587,587,588,588,589,589,590,590,591,591],
        [572,572,573,573,574,574,575,575,576,576,577,577,578,578,579,579,580,580,581,581,582,582,583,583,584,584,585,585,586,586,587,587,588,588,589,589,590,590,591,591]]

delta_t = [\
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]

cells_to_refine=[]
#cells_to_refine = [\
#        [12,12],[12,13],[12,14],[12,15],[12,16],[12,17],[12,18],[12,19],[12,20],[12,21],[12,22],[12,23],[12,24],[12,25],[12,26],[12,27],
#        [13,12],[13,13],[13,14],[13,15],[13,16],[13,17],[13,18],[13,19],[13,20],[13,21],[13,22],[13,23],[13,24],[13,25],[13,26],[13,27],
#        [14,12],[14,13],[14,14],[14,15],[14,16],[14,17],[14,18],[14,19],[14,20],[14,21],[14,22],[14,23],[14,24],[14,25],[14,26],[14,27],
#        [15,12],[15,13],[15,14],[15,15],[15,16],[15,17],[15,18],[15,19],[15,20],[15,21],[15,22],[15,23],[15,24],[15,25],[15,26],[15,27],
#        [16,12],[16,13],[16,14],[16,15],[16,16],[16,17],[16,18],[16,19],[16,20],[16,21],[16,22],[16,23],[16,24],[16,25],[16,26],[16,27],
#        [17,12],[17,13],[17,14],[17,15],[17,16],[17,17],[17,18],[17,19],[17,20],[17,21],[17,22],[17,23],[17,24],[17,25],[17,26],[17,27],
#        [18,12],[18,13],[18,14],[18,15],[18,16],[18,17],[18,18],[18,19],[18,20],[18,21],[18,22],[18,23],[18,24],[18,25],[18,26],[18,27],
#        [19,12],[19,13],[19,14],[19,15],[19,16],[19,17],[19,18],[19,19],[19,20],[19,21],[19,22],[19,23],[19,24],[19,25],[19,26],[19,27],
#        [20,12],[20,13],[20,14],[20,15],[20,16],[20,17],[20,18],[20,19],[20,20],[20,21],[20,22],[20,23],[20,24],[20,25],[20,26],[20,27],
#        [21,12],[21,13],[21,14],[21,15],[21,16],[21,17],[21,18],[21,19],[21,20],[21,21],[21,22],[21,23],[21,24],[21,25],[21,26],[21,27],
#        [22,12],[22,13],[22,14],[22,15],[22,16],[22,17],[22,18],[22,19],[22,20],[22,21],[22,22],[22,23],[22,24],[22,25],[22,26],[22,27],
#        [23,12],[23,13],[23,14],[23,15],[23,16],[23,17],[23,18],[23,19],[23,20],[23,21],[23,22],[23,23],[23,24],[23,25],[23,26],[23,27],
#        [24,12],[24,13],[24,14],[24,15],[24,16],[24,17],[24,18],[24,19],[24,20],[24,21],[24,22],[24,23],[24,24],[24,25],[24,26],[24,27],
#        [25,12],[25,13],[25,14],[25,15],[25,16],[25,17],[25,18],[25,19],[25,20],[25,21],[25,22],[25,23],[25,24],[25,25],[25,26],[25,27],
#        [26,12],[26,13],[26,14],[26,15],[26,16],[26,17],[26,18],[26,19],[26,20],[26,21],[26,22],[26,23],[26,24],[26,25],[26,26],[26,27],
#        [27,12],[27,13],[27,14],[27,15],[27,16],[27,17],[27,18],[27,19],[27,20],[27,21],[27,22],[27,23],[27,24],[27,25],[27,26],[27,27]]

#n_x = 20
#n_y = 20
#n_p = [\
#        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9],
#        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9],
#        [10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29],
#        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29],
#        [30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
#        [30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
#        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49],
#        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49],
#        [50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
#        [50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
#        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69],
#        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69],
#        [70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
#        [70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
#        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89],
#        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89],
#        [90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99],
#        [90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99]]
#
#delta_t = [\
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4]]
#
#cells_to_refine = []
#cells_to_refine = [\
#        [0,1],[0,3],[0,5],[0,7],[0,9],[0,11],[0,13],[0,15],[0,17],[0,19],
#        [1,1],[1,3],[1,5],[1,7],[1,9],[1,11],[1,13],[1,15],[1,17],[1,19],
#        [2,1],[2,3],[2,5],[2,7],[2,9],[2,11],[2,13],[2,15],[2,17],[2,19],
#        [3,1],[3,3],[3,5],[3,7],[3,9],[3,11],[3,13],[3,15],[3,17],[3,19],
#        [4,1],[4,3],[4,5],[4,7],[4,9],[4,11],[4,13],[4,15],[4,17],[4,19],
#        [5,1],[5,3],[5,5],[5,7],[5,9],[5,11],[5,13],[5,15],[5,17],[5,19],
#        [6,1],[6,3],[6,5],[6,7],[6,9],[6,11],[6,13],[6,15],[6,17],[6,19],
#        [7,1],[7,3],[7,5],[7,7],[7,9],[7,11],[7,13],[7,15],[7,17],[7,19],
#        [8,1],[8,3],[8,5],[8,7],[8,9],[8,11],[8,13],[8,15],[8,17],[8,19],
#        [9,1],[9,3],[9,5],[9,7],[9,9],[9,11],[9,13],[9,15],[9,17],[9,19],
#        [10,1],[10,3],[10,5],[10,7],[10,9],[10,11],[10,13],[10,15],[10,17],[10,19],
#        [11,1],[11,3],[11,5],[11,7],[11,9],[11,11],[11,13],[11,15],[11,17],[11,19],
#        [12,1],[12,3],[12,5],[12,7],[12,9],[12,11],[12,13],[12,15],[12,17],[12,19],
#        [13,1],[13,3],[13,5],[13,7],[13,9],[13,11],[13,13],[13,15],[13,17],[13,19],
#        [14,1],[14,3],[14,5],[14,7],[14,9],[14,11],[14,13],[14,15],[14,17],[14,19],
#        [15,1],[15,3],[15,5],[15,7],[15,9],[15,11],[15,13],[15,15],[15,17],[15,19],
#        [16,1],[16,3],[16,5],[16,7],[16,9],[16,11],[16,13],[16,15],[16,17],[16,19],
#        [17,1],[17,3],[17,5],[17,7],[17,9],[17,11],[17,13],[17,15],[17,17],[17,19],
#        [18,1],[18,3],[18,5],[18,7],[18,9],[18,11],[18,13],[18,15],[18,17],[18,19],
#        [19,1],[19,3],[19,5],[19,7],[19,9],[19,11],[19,13],[19,15],[19,17],[19,19]]
#
#n_x = 40
#n_y = 40
#n_p = [\
#        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19],
#        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
#        [20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39],
#        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
#        [40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59],
#        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
#        [60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79],
#        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99],
#        [80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94,95,95,96,96,97,97,98,98,99,99],
#        [100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119],
#        [100,100,101,101,102,102,103,103,104,104,105,105,106,106,107,107,108,108,109,109,110,110,111,111,112,112,113,113,114,114,115,115,116,116,117,117,118,118,119,119],
#        [120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139],
#        [120,120,121,121,122,122,123,123,124,124,125,125,126,126,127,127,128,128,129,129,130,130,131,131,132,132,133,133,134,134,135,135,136,136,137,137,138,138,139,139],
#        [140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159],
#        [140,140,141,141,142,142,143,143,144,144,145,145,146,146,147,147,148,148,149,149,150,150,151,151,152,152,153,153,154,154,155,155,156,156,157,157,158,158,159,159],
#        [160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179],
#        [160,160,161,161,162,162,163,163,164,164,165,165,166,166,167,167,168,168,169,169,170,170,171,171,172,172,173,173,174,174,175,175,176,176,177,177,178,178,179,179],
#        [180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191,191,192,192,193,193,194,194,195,195,196,196,197,197,198,198,199,199],
#        [180,180,181,181,182,182,183,183,184,184,185,185,186,186,187,187,188,188,189,189,190,190,191,191,192,192,193,193,194,194,195,195,196,196,197,197,198,198,199,199],
#        [200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208,209,209,210,210,211,211,212,212,213,213,214,214,215,215,216,216,217,217,218,218,219,219],
#        [200,200,201,201,202,202,203,203,204,204,205,205,206,206,207,207,208,208,209,209,210,210,211,211,212,212,213,213,214,214,215,215,216,216,217,217,218,218,219,219],
#        [220,220,221,221,222,222,223,223,224,224,225,225,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,237,238,238,239,239],
#        [220,220,221,221,222,222,223,223,224,224,225,225,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,235,235,236,236,237,237,238,238,239,239],
#        [240,240,241,241,242,242,243,243,244,244,245,245,246,246,247,247,248,248,249,249,250,350,351,251,252,252,253,253,254,254,255,255,256,246,257,257,258,258,259,259],
#        [240,240,241,241,242,242,243,243,244,244,245,245,246,246,247,247,248,248,249,249,250,350,351,251,252,252,253,253,254,254,255,255,256,246,257,257,258,258,259,259],
#        [260,260,261,261,262,262,263,263,264,264,265,265,266,266,267,267,268,268,269,269,270,270,271,271,272,272,273,273,274,274,275,275,276,276,277,277,278,278,279,279],
#        [260,260,261,261,262,262,263,263,264,264,265,265,266,266,267,267,268,268,269,269,270,270,271,271,272,272,273,273,274,274,275,275,276,276,277,277,278,278,279,279],
#        [280,280,281,281,282,282,283,283,284,284,285,285,286,286,287,287,288,288,289,289,290,290,291,291,292,292,293,293,294,294,295,295,296,296,297,297,298,298,299,299],
#        [280,280,281,281,282,282,283,283,284,284,285,285,286,286,287,287,288,288,289,289,290,290,291,291,292,292,293,293,294,294,295,295,296,296,297,297,298,298,299,299],
#        [300,300,301,301,302,302,303,303,304,304,305,305,306,306,307,307,308,308,309,309,310,310,311,311,312,312,313,313,314,314,315,315,316,316,317,317,318,318,319,319],
#        [300,300,301,301,302,302,303,303,304,304,305,305,306,306,307,307,308,308,309,309,310,310,311,311,312,312,313,313,314,314,315,315,316,316,317,317,318,318,319,319],
#        [320,320,321,321,322,322,323,323,324,324,325,325,326,326,327,327,328,328,329,329,330,330,331,331,332,332,333,333,334,334,335,335,336,336,337,337,338,338,339,339],
#        [320,320,321,321,322,322,323,323,324,324,325,325,326,326,327,327,328,328,329,329,330,330,331,331,332,332,333,333,334,334,335,335,336,336,337,337,338,338,339,339],
#        [340,340,341,341,342,342,343,343,344,344,345,345,346,346,347,347,348,348,349,349,350,350,351,351,352,352,353,353,354,354,355,355,356,356,357,357,358,358,359,359],
#        [340,340,341,341,342,342,343,343,344,344,345,345,346,346,347,347,348,348,349,349,350,350,351,351,352,352,353,353,354,354,355,355,356,356,357,357,358,358,359,359],
#        [360,360,361,361,362,362,363,363,364,364,365,365,366,366,367,367,368,368,369,369,370,370,371,371,372,372,373,373,374,374,375,375,376,376,377,377,378,378,379,379],
#        [360,360,361,361,362,362,363,363,364,364,365,365,366,366,367,367,368,368,369,369,370,370,371,371,372,372,373,373,374,374,375,375,376,376,377,377,378,378,379,379],
#        [380,380,381,381,382,382,383,383,384,384,385,385,386,386,387,387,388,388,389,389,390,390,391,391,392,392,393,393,394,394,395,395,396,396,397,397,398,398,399,399],
#        [380,380,381,381,382,382,383,383,384,384,385,385,386,386,387,387,388,388,389,389,390,390,391,391,392,392,393,393,394,394,395,395,396,396,397,397,398,398,399,399]]
#
#delta_t = [\
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4],
#        [1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4,1,4]]
#
#cells_to_refine =[[]]
#cells_to_refine = [\
#        [0,1],[0,3],[0,5],[0,7],[0,9],[0,11],[0,13],[0,15],[0,17],[0,19],[0,21],[0,23],[0,25],[0,27],[0,29],[0,31],[0,33],[0,35],[0,37],[0,39],
#        [1,1],[1,3],[1,5],[1,7],[1,9],[1,11],[1,13],[1,15],[1,17],[1,19],[1,21],[1,23],[1,25],[1,27],[1,29],[1,31],[1,33],[1,35],[1,37],[1,39],
#        [2,1],[2,3],[2,5],[2,7],[2,9],[2,11],[2,13],[2,15],[2,17],[2,19],[2,21],[2,23],[2,25],[2,27],[2,29],[2,31],[2,33],[2,35],[2,37],[2,39],
#        [3,1],[3,3],[3,5],[3,7],[3,9],[3,11],[3,13],[3,15],[3,17],[3,19],[3,21],[3,23],[3,25],[3,27],[3,29],[3,31],[3,33],[3,35],[3,37],[3,39],
#        [4,1],[4,3],[4,5],[4,7],[4,9],[4,11],[4,13],[4,15],[4,17],[4,19],[4,21],[4,23],[4,25],[4,27],[4,29],[4,31],[4,33],[4,35],[4,37],[4,39],
#        [5,1],[5,3],[5,5],[5,7],[5,9],[5,11],[5,13],[5,15],[5,17],[5,19],[5,21],[5,23],[5,25],[5,27],[5,29],[5,31],[5,33],[5,35],[5,37],[5,39],
#        [6,1],[6,3],[6,5],[6,7],[6,9],[6,11],[6,13],[6,15],[6,17],[6,19],[6,21],[6,23],[6,25],[6,27],[6,29],[6,31],[6,33],[6,35],[6,37],[6,39],
#        [7,1],[7,3],[7,5],[7,7],[7,9],[7,11],[7,13],[7,15],[7,17],[7,19],[7,21],[7,23],[7,25],[7,27],[7,29],[7,31],[7,33],[7,35],[7,37],[7,39],
#        [8,1],[8,3],[8,5],[8,7],[8,9],[8,11],[8,13],[8,15],[8,17],[8,19],[8,21],[8,23],[8,25],[8,27],[8,29],[8,31],[8,33],[8,35],[8,37],[8,39],
#        [9,1],[9,3],[9,5],[9,7],[9,9],[9,11],[9,13],[9,15],[9,17],[9,19],[9,21],[9,23],[9,25],[9,27],[9,29],[9,31],[9,33],[9,35],[9,37],[9,39],
#        [10,1],[10,3],[10,5],[10,7],[10,9],[10,11],[10,13],[10,15],[10,17],[10,19],[10,21],[10,23],[10,25],[10,27],[10,29],[10,31],[10,33],[10,35],[10,37],[10,39],
#        [11,1],[11,3],[11,5],[11,7],[11,9],[11,11],[11,13],[11,15],[11,17],[11,19],[11,21],[11,23],[11,25],[11,27],[11,29],[11,31],[11,33],[11,35],[11,37],[11,39],
#        [12,1],[12,3],[12,5],[12,7],[12,9],[12,11],[12,13],[12,15],[12,17],[12,19],[12,21],[12,23],[12,25],[12,27],[12,29],[12,31],[12,33],[12,35],[12,37],[12,39],
#        [13,1],[13,3],[13,5],[13,7],[13,9],[13,11],[13,13],[13,15],[13,17],[13,19],[13,21],[13,23],[13,25],[13,27],[13,29],[13,31],[13,33],[13,35],[13,37],[13,39],
#        [14,1],[14,3],[14,5],[14,7],[14,9],[14,11],[14,13],[14,15],[14,17],[14,19],[14,21],[14,23],[14,25],[14,27],[14,29],[14,31],[14,33],[14,35],[14,37],[14,39],
#        [15,1],[15,3],[15,5],[15,7],[15,9],[15,11],[15,13],[15,15],[15,17],[15,19],[15,21],[15,23],[15,25],[15,27],[15,29],[15,31],[15,33],[15,35],[15,37],[15,39],
#        [16,1],[16,3],[16,5],[16,7],[16,9],[16,11],[16,13],[16,15],[16,17],[16,19],[16,21],[16,23],[16,25],[16,27],[16,29],[16,31],[16,33],[16,35],[16,37],[16,39],
#        [17,1],[17,3],[17,5],[17,7],[17,9],[17,11],[17,13],[17,15],[17,17],[17,19],[17,21],[17,23],[17,25],[17,27],[17,29],[17,31],[17,33],[17,35],[17,37],[17,39],
#        [18,1],[18,3],[18,5],[18,7],[18,9],[18,11],[18,13],[18,15],[18,17],[18,19],[18,21],[18,23],[18,25],[18,27],[18,29],[18,31],[18,33],[18,35],[18,37],[18,39],
#        [19,1],[19,3],[19,5],[19,7],[19,9],[19,11],[19,13],[19,15],[19,17],[19,19],[19,21],[19,23],[19,25],[19,27],[19,29],[19,31],[19,33],[19,35],[19,37],[19,39],
#        [20,1],[20,3],[20,5],[20,7],[20,9],[20,11],[20,13],[20,15],[20,17],[20,19],[20,21],[20,23],[20,25],[20,27],[20,29],[20,31],[20,33],[20,35],[20,37],[20,39],
#        [21,1],[21,3],[21,5],[21,7],[21,9],[21,11],[21,13],[21,15],[21,17],[21,19],[21,21],[21,23],[21,25],[21,27],[21,29],[21,31],[21,33],[21,35],[21,37],[21,39],
#        [22,1],[22,3],[22,5],[22,7],[22,9],[22,11],[22,13],[22,15],[22,17],[22,19],[22,21],[22,23],[22,25],[22,27],[22,29],[22,31],[22,33],[22,35],[22,37],[22,39],
#        [23,1],[23,3],[23,5],[23,7],[23,9],[23,11],[23,13],[23,15],[23,17],[23,19],[23,21],[23,23],[23,25],[23,27],[23,29],[23,31],[23,33],[23,35],[23,37],[23,39],
#        [24,1],[24,3],[24,5],[24,7],[24,9],[24,11],[24,13],[24,15],[24,17],[24,19],[24,21],[24,23],[24,25],[24,27],[24,29],[24,31],[24,33],[24,35],[24,37],[24,39],
#        [25,1],[25,3],[25,5],[25,7],[25,9],[25,11],[25,13],[25,15],[25,17],[25,19],[25,21],[25,23],[25,25],[25,27],[25,29],[25,31],[25,33],[25,35],[25,37],[25,39],
#        [26,1],[26,3],[26,5],[26,7],[26,9],[26,11],[26,13],[26,15],[26,17],[26,19],[26,21],[26,23],[26,25],[26,27],[26,29],[26,31],[26,33],[26,35],[26,37],[26,39],
#        [27,1],[27,3],[27,5],[27,7],[27,9],[27,11],[27,13],[27,15],[27,17],[27,19],[27,21],[27,23],[27,25],[27,27],[27,29],[27,31],[27,33],[27,35],[27,37],[27,39],
#        [28,1],[28,3],[28,5],[28,7],[28,9],[28,11],[28,13],[28,15],[28,17],[28,19],[28,21],[28,23],[28,25],[28,27],[28,29],[28,31],[28,33],[28,35],[28,37],[28,39],
#        [29,1],[29,3],[29,5],[29,7],[29,9],[29,11],[29,13],[29,15],[29,17],[29,19],[29,21],[29,23],[29,25],[29,27],[29,29],[29,31],[29,33],[29,35],[29,37],[29,39],
#        [30,1],[30,3],[30,5],[30,7],[30,9],[30,11],[30,13],[30,15],[30,17],[30,19],[30,21],[30,23],[30,25],[30,27],[30,29],[30,31],[30,33],[30,35],[30,37],[30,39],
#        [31,1],[31,3],[31,5],[31,7],[31,9],[31,11],[31,13],[31,15],[31,17],[31,19],[31,21],[31,23],[31,25],[31,27],[31,29],[31,31],[31,33],[31,35],[31,37],[31,39],
#        [32,1],[32,3],[32,5],[32,7],[32,9],[32,11],[32,13],[32,15],[32,17],[32,19],[32,21],[32,23],[32,25],[32,27],[32,29],[32,31],[32,33],[32,35],[32,37],[32,39],
#        [33,1],[33,3],[33,5],[33,7],[33,9],[33,11],[33,13],[33,15],[33,17],[33,19],[33,21],[33,23],[33,25],[33,27],[33,29],[33,31],[33,33],[33,35],[33,37],[33,39],
#        [34,1],[34,3],[34,5],[34,7],[34,9],[34,11],[34,13],[34,15],[34,17],[34,19],[34,21],[34,23],[34,25],[34,27],[34,29],[34,31],[34,33],[34,35],[34,37],[34,39],
#        [35,1],[35,3],[35,5],[35,7],[35,9],[35,11],[35,13],[35,15],[35,17],[35,19],[35,21],[35,23],[35,25],[35,27],[35,29],[35,31],[35,33],[35,35],[35,37],[35,39],
#        [36,1],[36,3],[36,5],[36,7],[36,9],[36,11],[36,13],[36,15],[36,17],[36,19],[36,21],[36,23],[36,25],[36,27],[36,29],[36,31],[36,33],[36,35],[36,37],[36,39],
#        [37,1],[37,3],[37,5],[37,7],[37,9],[37,11],[37,13],[37,15],[37,17],[37,19],[37,21],[37,23],[37,25],[37,27],[37,29],[37,31],[37,33],[37,35],[37,37],[37,39],
#        [38,1],[38,3],[38,5],[38,7],[38,9],[38,11],[38,13],[38,15],[38,17],[38,19],[38,21],[38,23],[38,25],[38,27],[38,29],[38,31],[38,33],[38,35],[38,37],[38,39],
#        [39,1],[39,3],[39,5],[39,7],[39,9],[39,11],[39,13],[39,15],[39,17],[39,19],[39,21],[39,23],[39,25],[39,27],[39,29],[39,31],[39,33],[39,35],[39,37],[39,39]]


print('start building tasks')
tasks = CAP_PFB.build_tasks(n_x, n_y, n_p, delta_t, sn, cells_to_refine)
if randomized is True:
    random.shuffle(tasks)
cap_pfb = CAP_PFB.CAP_PFB(tasks, max_it, tol, n_p, forbid_oscillations,
                          do_local_search)
cap_pfb.Run(init_sched)
end = time.time()
print('Elapsed time', end-start)
print()
print()
if print_output is True:
    print('Scheduling')
    schedule = cap_pfb.schedule
    n_procs = max(max(n_p))+1
    part_schedule = []
    for i in range(n_procs):
        part_schedule.append([])
    for task in schedule:
        part_schedule[task[0].subdomain_id].append(task)
    for i in range(n_procs):
        part_schedule[i].sort(key=lambda tup: tup[1])
    for i in range(n_procs):
        print()
        print('Processor', i)
        for task in part_schedule[i]:
            print(task)

if branch_and_bound is True:
    branch_and_bound = BRANCH_AND_BOUND.BRANCH_AND_BOUND(tasks, max(max(n_p))+1,
            cap_pfb.end_time-cap_pfb.start_time, print_output)
    branch_and_bound.Run()
